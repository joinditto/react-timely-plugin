{"version":3,"file":"index.js","sources":["../src/components/TimelyModal.tsx","../src/timely.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport ReactModal from 'react-modal'\n\nimport { ReactComponent as CloseIcon } from '../assets/close-icon.svg'\n\nexport interface StylesDictionary {\n  [Key: string]: React.CSSProperties\n}\n\ninterface TimelyModalProps {\n  isOpen: boolean\n  onClose: () => void\n}\n\nconst customModalStylesMd = {\n  overlay: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    overflow: 'hidden',\n    zIndex: '9999',\n    backgroundColor: 'rgba(31,31,31,0.4)'\n  },\n  content: {\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    width: '80%',\n    minWidth: '900px',\n    maxWidth: '1000px',\n    height: '90%',\n    maxHeight: '680px',\n    padding: 0,\n    background: 'transparent',\n    border: 'none',\n    overflow: 'hidden'\n  }\n}\n\nconst customModalStylesXs = {\n  overlay: {\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    overflow: 'hidden',\n    zIndex: '9999',\n    backgroundColor: 'rgba(31,31,31,0.4)'\n  },\n  content: {\n    top: 0,\n    left: 0,\n    width: '100%',\n    padding: 0,\n    background: 'transparent',\n    border: 'none',\n    overflow: 'hidden',\n    inset: '50px 0 0 0'\n  }\n}\n\nconst styles: StylesDictionary = {\n  closeButtonMd: {\n    position: 'absolute',\n    top: '25px',\n    right: '25px',\n    color: '#fff',\n    width: '19px',\n    height: '19px',\n    cursor: 'pointer',\n    background: 'url(../assets/close-icon.svg) no-repeat',\n    backgroundSize: 'contain',\n    zIndex: 10000\n  },\n  closeButtonXs: {\n    position: 'absolute',\n    top: '10px',\n    right: '10px',\n    color: '#fff',\n    width: '15px',\n    height: '15px',\n    cursor: 'pointer',\n    background: 'url(../assets/close-icon.svg) no-repeat',\n    backgroundSize: 'contain',\n    zIndex: 10000\n  }\n}\n\nconst TimelyModal: React.FC<TimelyModalProps> = ({\n  isOpen,\n  onClose,\n  children\n}) => {\n  const [viewport, setViewport] = useState<{ width: Number; height: number }>({\n    width: document.documentElement.clientWidth,\n    height: document.documentElement.clientHeight\n  })\n\n  const handleViewportChange = () => {\n    setViewport({\n      width: document.documentElement.clientWidth,\n      height: document.documentElement.clientHeight\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('resize', handleViewportChange)\n    return () => window.removeEventListener('resize', handleViewportChange)\n  }, [])\n\n  return (\n    <ReactModal\n      isOpen={isOpen}\n      style={\n        viewport && viewport.width < 960\n          ? customModalStylesXs\n          : customModalStylesMd\n      }\n      overlayElement={(props, contentElement) => (\n        <div>\n          <div\n            style={\n              viewport && viewport.width < 960\n                ? styles.closeButtonXs\n                : styles.closeButtonMd\n            }\n            onClick={onClose}\n          >\n            <CloseIcon />\n          </div>\n          <div {...props}>{contentElement}</div>\n        </div>\n      )}\n      ariaHideApp={false}\n      onAfterOpen={() => (document.body.style.overflow = 'hidden')}\n      onAfterClose={() => (document.body.style.overflow = 'unset')}\n    >\n      {children}\n    </ReactModal>\n  )\n}\n\nexport default TimelyModal\n","import React, { Fragment, useState } from 'react'\nimport TimelyModal from './components/TimelyModal'\nimport { ReactComponent as Loader } from './assets/loader.svg'\n\ninterface TimelyProps {\n  isOpen: boolean\n  onClose?: () => void\n}\n\ntype Optional<T extends object> = {\n  [P in keyof T]?: T[P]\n}\n\nexport type Prefill = Optional<{\n  name: string\n  email: string\n  phone: string\n  product: string\n  query: string\n  date: Date\n}>\n\nexport type Utm = Optional<{\n  utmCampaign: string\n  utmSource: string\n  utmMedium: string\n  utmContent: string\n  utmTerm: string\n}>\n\nexport type IframeTitle = string\n\ninterface TimelyWidgetProps {\n  url: string\n  prefill?: Prefill\n  utm?: Utm\n  iframeTitle?: IframeTitle\n}\n\ninterface TimelyWidgetState {\n  isOpen: boolean\n  content: JSX.Element | null\n}\n\nclass TimelyWidget extends React.Component<any, TimelyWidgetState> {\n  static singletonRef: any\n\n  static toggle(props: TimelyProps) {\n    TimelyWidget.singletonRef.process(props)\n  }\n\n  constructor(props: any) {\n    super(props)\n\n    this.state = {\n      isOpen: false,\n      content: null\n    }\n\n    TimelyWidget.singletonRef = this\n  }\n\n  show = (props: TimelyWidgetProps) => {\n    this.setState({\n      isOpen: true,\n      content: <TimelyIframe {...props} />\n    })\n  }\n\n  close = () => {\n    this.setState({ isOpen: false })\n  }\n\n  render() {\n    const { isOpen } = this.state\n\n    return (\n      <TimelyModal isOpen={isOpen} onClose={this.close}>\n        <Fragment>{this.state.content}</Fragment>\n      </TimelyModal>\n    )\n  }\n}\n\nconst TimelyProvider: React.FC = ({ children }) => {\n  return (\n    <Fragment>\n      {children}\n      <TimelyWidget />\n    </Fragment>\n  )\n}\n\nexport { TimelyProvider }\n\nexport const TimelyIframe: React.FC<TimelyWidgetProps> = ({\n  url,\n  utm,\n  iframeTitle\n}) => {\n  const [loading, showLoader] = useState<boolean>(true)\n\n  const formUrl = () => {\n    const queryStringIndex = url.indexOf('?')\n    const hasQueryString = queryStringIndex > -1\n    const queryString = hasQueryString ? url.slice(queryStringIndex + 1) : null\n    const baseUrl = hasQueryString ? url.slice(0, queryStringIndex) : url\n\n    const updatedQueryString = [\n      queryString,\n      utm\n        ? Object.keys(utm)\n            .map((utmParam) => `${utmParam}=${utm[utmParam]}`)\n            .join('&')\n        : null\n    ]\n      .filter((item) => item !== null)\n      .join('&')\n\n    return `${baseUrl}?${updatedQueryString}`\n  }\n\n  const finalUrl = formUrl()\n\n  return (\n    <div\n      style={{\n        width: '100%',\n        height: '100%',\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'center',\n        alignItems: 'center'\n      }}\n    >\n      {loading && (\n        <div\n          style={{\n            position: 'absolute',\n            width: '100%',\n            height: '100%',\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center',\n            zIndex: -1\n          }}\n        >\n          <Loader\n            style={{\n              width: 75,\n              height: 57\n            }}\n          />\n        </div>\n      )}\n      <iframe\n        src={finalUrl}\n        frameBorder={0}\n        width='100%'\n        height='100%'\n        title={iframeTitle ? iframeTitle : 'Ditto Timely'}\n        onLoad={() => showLoader(false)}\n        allowTransparency={true}\n        style={{ visibility: loading ? 'hidden' : 'visible' }}\n      />\n    </div>\n  )\n}\n\nexport const openPopupWidget = (options: TimelyWidgetProps) => {\n  TimelyWidget.singletonRef.show(options)\n}\n"],"names":["customModalStylesMd","overlay","top","left","right","bottom","overflow","zIndex","backgroundColor","content","transform","width","minWidth","maxWidth","height","maxHeight","padding","background","border","customModalStylesXs","inset","styles","closeButtonMd","position","color","cursor","backgroundSize","closeButtonXs","TimelyModal","isOpen","onClose","children","useState","document","documentElement","clientWidth","clientHeight","viewport","setViewport","handleViewportChange","useEffect","window","addEventListener","removeEventListener","React","ReactModal","style","overlayElement","props","contentElement","onClick","CloseIcon","ariaHideApp","onAfterOpen","body","onAfterClose","TimelyWidget","setState","TimelyIframe","state","singletonRef","toggle","process","render","close","Fragment","Component","TimelyProvider","url","utm","iframeTitle","loading","showLoader","formUrl","queryStringIndex","indexOf","hasQueryString","queryString","slice","baseUrl","updatedQueryString","Object","keys","map","utmParam","join","filter","item","finalUrl","display","flexDirection","justifyContent","alignItems","Loader","src","frameBorder","title","onLoad","allowTransparency","visibility","openPopupWidget","options","show"],"mappings":"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"}